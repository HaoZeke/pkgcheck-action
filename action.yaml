name: 'pkgcheck'
description: 'Test your package with {pkgcheck}.'
inputs:
  cache-version:
    description: 'Integer to use as cache version. Increment to use new cache.'
    required: true
    default: 1
    
runs:
  using: "composite"
  steps:
    - name: Checkout repo
      uses: actions/checkout@v2
      with:
         fetch-depth: 0
    - uses: r-lib/actions/setup-r-dependencies@v2
      with:
        cache-version: ${{ inputs.cache_version }}
        extra-packages: |
          local::.
          magrittr
          github::ropensci-review-tools/pkgcheck
    - name: Run pkgcheck
      id: pkgcheck
      run: source("${GITHUB_ACTION_PATH}/check.R")
      shell: Rscript {0}
    - uses: actions/upload-artifact@v2
      with:
        name: visual-network
        path: "${{ steps.pkgcheck.outputs.visnet_path }}"
    - uses: actions/upload-artifact@v2
      with:
        name: results
        path: "${{ steps.pkgcheck.outputs.results }}"
